const d=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function h(e,n){n?n={...d,...n}:n=d;const s=m(n);return s.dispatch(e),s.toString()}const x=Object.freeze(["prototype","__proto__","constructor"]);function m(e){let n="",s=new Map;const r=t=>{n+=t};return{toString(){return n},getContext(){return s},dispatch(t){return e.replacer&&(t=e.replacer(t)),this[t===null?"null":typeof t](t)},object(t){if(t&&typeof t.toJSON=="function")return this.object(t.toJSON());const i=Object.prototype.toString.call(t);let a="";const c=i.length;c<10?a="unknown:["+i+"]":a=i.slice(8,c-1),a=a.toLowerCase();let u=null;if((u=s.get(t))===void 0)s.set(t,s.size);else return this.dispatch("[CIRCULAR:"+u+"]");if(typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(t))return r("buffer:"),r(t.toString("utf8"));if(a!=="object"&&a!=="function"&&a!=="asyncfunction")this[a]?this[a](t):e.ignoreUnknown||this.unkown(t,a);else{let o=Object.keys(t);e.unorderedObjects&&(o=o.sort());let f=[];e.respectType!==!1&&!g(t)&&(f=x),e.excludeKeys&&(o=o.filter(l=>!e.excludeKeys(l)),f=f.filter(l=>!e.excludeKeys(l))),r("object:"+(o.length+f.length)+":");const p=l=>{this.dispatch(l),r(":"),e.excludeValues||this.dispatch(t[l]),r(",")};for(const l of o)p(l);for(const l of f)p(l)}},array(t,i){if(i=i===void 0?e.unorderedArrays!==!1:i,r("array:"+t.length+":"),!i||t.length<=1){for(const u of t)this.dispatch(u);return}const a=new Map,c=t.map(u=>{const o=m(e);o.dispatch(u);for(const[f,p]of o.getContext())a.set(f,p);return o.toString()});return s=a,c.sort(),this.array(c,!1)},date(t){return r("date:"+t.toJSON())},symbol(t){return r("symbol:"+t.toString())},unkown(t,i){if(r(i),!!t&&(r(":"),t&&typeof t.entries=="function"))return this.array(Array.from(t.entries()),!0)},error(t){return r("error:"+t.toString())},boolean(t){return r("bool:"+t)},string(t){r("string:"+t.length+":"),r(t)},function(t){r("fn:"),g(t)?this.dispatch("[native]"):this.dispatch(t.toString()),e.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this.object(t)},number(t){return r("number:"+t)},xml(t){return r("xml:"+t.toString())},null(){return r("Null")},undefined(){return r("Undefined")},regexp(t){return r("regex:"+t.toString())},uint8array(t){return r("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},uint8clampedarray(t){return r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},int8array(t){return r("int8array:"),this.dispatch(Array.prototype.slice.call(t))},uint16array(t){return r("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},int16array(t){return r("int16array:"),this.dispatch(Array.prototype.slice.call(t))},uint32array(t){return r("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},int32array(t){return r("int32array:"),this.dispatch(Array.prototype.slice.call(t))},float32array(t){return r("float32array:"),this.dispatch(Array.prototype.slice.call(t))},float64array(t){return r("float64array:"),this.dispatch(Array.prototype.slice.call(t))},arraybuffer(t){return r("arraybuffer:"),this.dispatch(new Uint8Array(t))},url(t){return r("url:"+t.toString())},map(t){r("map:");const i=[...t];return this.array(i,e.unorderedSets!==!1)},set(t){r("set:");const i=[...t];return this.array(i,e.unorderedSets!==!1)},file(t){return r("file:"),this.dispatch([t.name,t.size,t.type,t.lastModfied])},blob(){if(e.ignoreUnknown)return r("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},domwindow(){return r("domwindow")},bigint(t){return r("bigint:"+t.toString())},process(){return r("process")},timer(){return r("timer")},pipe(){return r("pipe")},tcp(){return r("tcp")},udp(){return r("udp")},tty(){return r("tty")},statwatcher(){return r("statwatcher")},securecontext(){return r("securecontext")},connection(){return r("connection")},zlib(){return r("zlib")},context(){return r("context")},nodescript(){return r("nodescript")},httpparser(){return r("httpparser")},dataview(){return r("dataview")},signal(){return r("signal")},fsevent(){return r("fsevent")},tlswrap(){return r("tlswrap")}}}const b="[native code] }",O=b.length;function g(e){return typeof e!="function"?!1:Function.prototype.toString.call(e).slice(-O)===b}function A(e,n,s={}){return e===n||h(e,s)===h(n,s)}function v(e,n,s={}){const r=y(e,s),t=y(n,s);return k(r,t,s)}function k(e,n,s={}){var i,a;const r=[],t=new Set([...Object.keys(e.props||{}),...Object.keys(n.props||{})]);if(e.props&&n.props)for(const c of t){const u=e.props[c],o=n.props[c];u&&o?r.push(...k((i=e.props)==null?void 0:i[c],(a=n.props)==null?void 0:a[c],s)):(u||o)&&r.push(new w((o||u).key,u?"removed":"added",o,u))}return t.size===0&&e.hash!==n.hash&&r.push(new w((n||e).key,"changed",n,e)),r}function y(e,n,s=""){if(e&&typeof e!="object")return new S(s,e,h(e,n));const r={},t=[];for(const i in e)r[i]=y(e[i],n,s?`${s}.${i}`:i),t.push(r[i].hash);return new S(s,e,`{${t.join(":")}}`,r)}class w{constructor(n,s,r,t){this.key=n,this.type=s,this.newValue=r,this.oldValue=t}toString(){return this.toJSON()}toJSON(){var n;switch(this.type){case"added":return`Added   \`${this.key}\``;case"removed":return`Removed \`${this.key}\``;case"changed":return`Changed \`${this.key}\` from \`${((n=this.oldValue)==null?void 0:n.toString())||"-"}\` to \`${this.newValue.toString()}\``}}}class S{constructor(n,s,r,t){this.key=n,this.value=s,this.hash=r,this.props=t}toString(){return this.props?`{${Object.keys(this.props).join(",")}}`:JSON.stringify(this.value)}toJSON(){const n=this.key||".";return this.props?`${n}({${Object.keys(this.props).join(",")}})`:`${n}(${this.value})`}}export{v as d,A as i};
